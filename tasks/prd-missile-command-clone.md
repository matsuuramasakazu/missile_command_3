# プロダクト要求仕様書 (PRD): Missile Command クローン

## 1. はじめに/概要

本ドキュメントは、Pythonのpygameライブラリを使用して、ATARIの名作アーケードゲーム「Missile Command」のクローンを開発するための要件を定義するものです。プレイヤーは、空から降り注ぐ隕石から6つの都市を守るため、3つのミサイル基地から迎撃ミサイルを発射します。ステージクリア型のゲームであり、プレイヤーの戦略的な判断力と素早い反射神経が試されます。

## 2. 目標

*   オリジナルの「Missile Command」が持つ、シンプルながら奥深いコアなゲームプレイ体験を忠実に再現する。
*   複数のステージ（レベル）制を導入し、プレイヤーが達成感と進行感を得られるようにする。
*   スコア、残り都市数、弾薬数などの情報を表示する明確なUIと、ゲームプレイを盛り上げる効果音を実装し、没入感のある体験を提供する。

## 3. ユーザーストーリー

*   **プレイヤーとして、** マウスを操作して空中の好きな場所を狙いたい。そうすることで、隕石を迎撃するための正確な爆発地点を指定できる。
*   **プレイヤーとして、** クリックした地点に最も近い基地からミサイルが自動で発射されるようにしたい。そうすることで、複数の基地を効率的に使って防衛できる。
*   **プレイヤーとして、** ミサイルの爆風で複数の隕石を一度に破壊したい。そうすることで、弾薬を節約し、危機的な状況を乗り越えられる。
*   **プレイヤーとして、** ステージをクリアして、より難易度の高い次のステージに挑戦したい。そうすることで、自分のスキルアップを実感できる。
*   **プレイヤーとして、** 画面上でスコア、都市の状況、各基地のミサイル残数を常に確認したい。そうすることで、戦況を正確に把握し、次の手を考えられる。

## 4. 機能要件

1.  **ゲーム画面とオブジェクト配置**
    1.1. 画面下部に地表を配置する。
    1.2. 地表に、左から「左ミサイル基地」「都市3個」「中央ミサイル基地」「都市3個」「右ミサイル基地」の順でオブジェクトを配置する。

2.  **プレイヤー操作**
    2.1. プレイヤーはマウスカーソルを動かして、ミサイルの爆発目標地点を照準する。
    2.2. マウスの左ボタンをクリックすると、そのカーソル位置が爆発目標地点として確定される。

3.  **ミサイルシステム**
    3.1. クリックされた目標地点に最も近い、破壊されていないミサイル基地からミサイルが1発発射される。
    3.2. 3つの各ミサイル基地は、それぞれ個別の弾薬数を持つ（例: 各10発）。
    3.3. 弾薬が尽きた、または破壊された基地からはミサイルを発射できない。
    3.4. 発射されたミサイルは目標地点に到達すると爆発し、一定時間、攻撃判定を持つ爆風がその場に残る。

4.  **隕石システム**
    4.1. ステージ開始時、画面上部のランダムな位置から隕石が出現し、地表の都市や基地に向かって落下する。
    4.2. 隕石には速度が異なるものが複数種類存在する。
    4.3. 隕石がプレイヤーのミサイルの爆風に触れると破壊される。
    4.4. 隕石が都市、ミサイル基地、または地表に到達すると爆発する。

5.  **破壊とゲームオーバー**
    5.1. 都市またはミサイル基地が、隕石またはプレイヤーのミサイルの爆風範囲内に入ると破壊される。
    5.2. すべての都市が破壊された時点でゲームオーバーとなる。

6.  **ゲーム進行**
    6.1. ゲームは複数のステージ（レベル）で構成される。
    6.2. ステージクリア条件は、「特定の数の隕石を破壊する」または「特定の時間、都市を守り抜く」こととする。
    6.3. ステージをクリアすると、残っている都市やミサイルに応じてボーナススコアが加算され、次のステージに進む。
    6.4.後のステージほど、隕石の数が増え、落下速度が速くなるなど、難易度が上昇する。

7.  **UI (ユーザーインターフェース)**
    7.1. 画面上に現在のスコアを常に表示する。
    7.2. 破壊されずに残っている都市の数を表示する。
    7.3. 各ミサイル基地の残りミサイル数を表示する。

## 5. 非目標 (スコープ外)

*   ミサイル発射や爆発、建物破壊の効果音
*   オンラインランキング機能
*   プレイヤー間の対戦・協力モード
*   背景音楽 (BGM)
*   ゲームの進行状況を保存・ロードする機能
*   破壊されると分裂する隕石

## 6. 設計上の考慮事項 (オプション)

*   グラフィックは、オリジナルのATARI版の雰囲気を尊重した、シンプルなピクセルアートスタイルを目指す。
*   都市、基地、ミサイル、爆発エフェクトなどは、四角形や円などの単純な幾何学的形状で表現する。
*   UI要素は、ゲームプレイエリアの邪魔にならないよう、画面の上部または下部にまとめて配置する。

## 7. 技術的な考慮事項 (オプション)

*   開発言語としてPython、ゲームライブラリとしてpygameを使用する。
*   マウスイベント（移動、クリック）を正確に処理し、プレイヤーの入力をゲームに反映させる。
*   ゲーム内の各要素（ミサイル、隕石、都市、基地など）を管理するためのPythonクラスをそれぞれ作成する。
*   当たり判定は、オブジェクトの座標と爆風の半径を比較する円と点の距離計算や、オブジェクトの矩形（Rect）を用いた衝突判定を実装する。

## 8. 成功指標

*   本仕様書の「4. 機能要件」に記載された項目がすべて実装され、意図通りに動作する。
*   ステージ1から複数のステージを連続してプレイでき、ステージクリアとゲームオーバーが正しく判定される。
*   ゲームプレイ中に致命的なエラーやクラッシュが発生しない。

## 9. 未解決の質問

*   スコアの具体的な計算ロジック（例: 隕石破壊: 25点、ステージクリア時の都市ボーナス: 100点/個）。
*   各ステージの具体的なクリア条件（例: ステージ1は隕石10個破壊、ステージ2は30秒防衛）。
*   ステージ進行に応じた難易度上昇の具体的な数値（例: 隕石の速度をステージごとに5%上昇させる）。